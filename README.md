# High-dimensional-mediation-analysis
High-dimensional mediation analysis for selecting DNA methylation Loci mediating childhood trauma and cortisol stress reactivity

Supplementary material to the manuscript _High-dimensional mediation analysis forselecting DNA methylation Loci mediating childhood trauma and cortisol stress reactivity_. 

`main.Rmd` shows the empirical analysis to study how DNA methylation plays a role in the regulation of human stress reactivity. This Rmd aims to reproduce the results in Section 3 of the paper.

Before running  main.Rmd, one should first open the .Rproj, download the data and specify the path of the data.

- Step 1. Make sure that first open `High-dimensional-mediation-analysis-JASA.Rproj` and then open `main.Rmd` in the Rstudio.
          This will help you to correctly setup working directory.

- Step 2. Download `E-GEOD-77445.processed.1.zip` as well as `E-GEOD-77445.processed.2.zip` from the website:
https://www.ebi.ac.uk/arrayexpress/experiments/E-GEOD-77445 and unzip them in the `data` folder.

- Step 3. Specify the `data` folder's absolute path to the `PATH` variable.

Note that there is no need to download `E-GEOD-77445.sdrf.txt`, which has different row length and cannot be read into R directly. 
We have downloaded and manually cleaned it. We saved it as `X.tsv` in the `data` folder because this file contains information about exposure variable $X$.

The rest of files are:

1. `utils_mediation.R` stores all the functions that will be used in `main.Rmd`.
2. `simulationPreprocessing.R` loads the processed data and prepare for simulation (section 4) part. Please run file before the following files, because all the simulations depend on this file's result.
3. `Simulation_no_confounders.R` performs simulation studies without confounding variables (section 4.1).
4. `Simulation_confounders.R` performs simulation studies with confounding variables (section 4.2)
5. `Simulation_compare_sigma1.R` compares estimated \hat{\sigma}_1 among three methods: our proposed new method, oracle and Zhou et al (2020).
6. `GlobalTestCompare.R' compares our method with global test

Other files:
7. `main.md` is a markdown file generated by `main.Rmd` which is easy-to-read on GitHub. 
             To display math formula correctly, one should set the appearance to day light (https://docs.github.com/en/enterprise-server@3.2/account-and-profile/setting-up-and-managing-your-github-user-account/managing-user-account-settings/managing-your-theme-settings)
